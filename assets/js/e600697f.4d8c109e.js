"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[12070],{94275:function(e,t,n){n.r(t),n.d(t,{assets:function(){return m},contentTitle:function(){return d},default:function(){return u},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return h}});var a=n(83117),o=n(80102),i=(n(67294),n(3905)),s=n(13904),r=["components"],l={title:"Moodle 4.0 developer update",tags:["Moodle 4.0","Core development"]},d=void 0,p={unversionedId:"devupdate",id:"devupdate",title:"Moodle 4.0 developer update",description:"This page highlights the important changes that are coming in Moodle 4.0 for developers. Including how the UX improvements impact custom themes, relevant API changes, and what you can do as developer to prepare for the 4.0 release.",source:"@site/docs/devupdate.md",sourceDirName:".",slug:"/devupdate",permalink:"/devdocs/docs/devupdate",draft:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/docs/devupdate.md",tags:[{label:"Moodle 4.0",permalink:"/devdocs/docs/tags/moodle-4-0"},{label:"Core development",permalink:"/devdocs/docs/tags/core-development"}],version:"current",lastUpdatedBy:"Andrew Lyons",lastUpdatedAt:1655463803,formattedLastUpdatedAt:"17/06/2022",frontMatter:{title:"Moodle 4.0 developer update",tags:["Moodle 4.0","Core development"]},sidebar:"docs",previous:{title:"Roles API",permalink:"/devdocs/docs/apis/subsystems/roles"},next:{title:"Moodle App",permalink:"/devdocs/docs/moodleapp"}},m={},h=[{value:"Navigation changes",id:"navigation-changes",level:2},{value:"Primary navigation",id:"primary-navigation",level:3},{value:"Secondary navigation",id:"secondary-navigation",level:3},{value:"Adding items to the navigation",id:"adding-items-to-the-navigation",level:4},{value:"Changing the order of tabs",id:"changing-the-order-of-tabs",level:4},{value:"Tertiary navigation",id:"tertiary-navigation",level:3},{value:"New API functions",id:"new-api-functions",level:3},{value:"Page API",id:"page-api",level:4},{value:"Navigation library",id:"navigation-library",level:4},{value:"The activity header class",id:"the-activity-header-class",level:4},{value:"Theme updates",id:"theme-updates",level:5},{value:"Component library",id:"component-library",level:2},{value:"Enabling the Component Library",id:"enabling-the-component-library",level:3},{value:"Documenting new UI Components",id:"documenting-new-ui-components",level:3},{value:"Theme changes",id:"theme-changes",level:2},{value:"Edit switch",id:"edit-switch",level:3},{value:"Login page",id:"login-page",level:3},{value:"The page footer",id:"the-page-footer",level:3},{value:"User initials as profile picture placeholder",id:"user-initials-as-profile-picture-placeholder",level:3},{value:"Removal of back to top link",id:"removal-of-back-to-top-link",level:3},{value:"Styling changes",id:"styling-changes",level:3},{value:"New layout page",id:"new-layout-page",level:3},{value:"Question bank changes",id:"question-bank-changes",level:2},{value:"Question type plugins",id:"question-type-plugins",level:3},{value:"New plugin type: qbank plugins",id:"new-plugin-type-qbank-plugins",level:3},{value:"Activities that use questions",id:"activities-that-use-questions",level:3},{value:"The course format system",id:"the-course-format-system",level:2},{value:"Mandatory renderer in course formats",id:"mandatory-renderer-in-course-formats",level:3},{value:"New format base class",id:"new-format-base-class",level:3},{value:"New course output classes and mustache files",id:"new-course-output-classes-and-mustache-files",level:3},{value:"Course editor JavaScript modules and frontend components",id:"course-editor-javascript-modules-and-frontend-components",level:3},{value:"Other course related 4.0 changes",id:"other-course-related-40-changes",level:3},{value:"Behat changes",id:"behat-changes",level:2},{value:"New steps",id:"new-steps",level:3},{value:"Boost steps",id:"boost-steps",level:3},{value:"Modified steps",id:"modified-steps",level:3},{value:"Removed steps",id:"removed-steps",level:3},{value:"Other things to consider",id:"other-things-to-consider",level:3},{value:"Other",id:"other",level:2},{value:"Core plugins review",id:"core-plugins-review",level:3},{value:"Core blocks cleanup",id:"core-blocks-cleanup",level:3},{value:"Site admin presets plugin",id:"site-admin-presets-plugin",level:3},{value:"JavaScript browser support changes",id:"javascript-browser-support-changes",level:3},{value:"The course index element",id:"the-course-index-element",level:3},{value:"Activity icons",id:"activity-icons",level:3},{value:"I&#39;m a developer, what do I need to know?",id:"im-a-developer-what-do-i-need-to-know",level:2},{value:"Modules",id:"modules",level:3},{value:"Themes",id:"themes",level:3},{value:"Course format",id:"course-format",level:3},{value:"Other plugins",id:"other-plugins",level:3}],c={toc:h};function u(e){var t=e.components,n=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(s.Z,(0,a.Z)({frontMatter:l},void 0!==p?{metadata:p}:{},{mdxType:"MoodlePageBanner"})),(0,i.kt)("p",null,"This page highlights the important changes that are coming in Moodle 4.0 for developers. Including how the UX improvements impact custom themes, relevant API changes, and what you can do as developer to prepare for the 4.0 release."),(0,i.kt)("h2",{id:"navigation-changes"},"Navigation changes"),(0,i.kt)("p",null,"The core Navigation API has been left mostly untouched. The callbacks to all navigation callbacks remain unchanged and will be called as part of the regular ",(0,i.kt)("inlineCode",{parentName:"p"},"navigation")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"settingsnav")," initialisation. Some new core classes have been created and exist within a new namespace ",(0,i.kt)("inlineCode",{parentName:"p"},"core/navigation")," and serve as conduit to rearrange, cherry-pick existing navigation nodes from the navigation/settingsnav trees and display within the respective navigation type. As such, it is highly recommended to provide unique keys for custom navigation nodes as this helps in the cherry-picking / rearranging process within the new classes."),(0,i.kt)("h3",{id:"primary-navigation"},"Primary navigation"),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The menus have been transitioned to be rendered via templates. Refer to ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/moodle/moodle/blob/v4.0.0/lib/templates/user_menu.mustache"},(0,i.kt)("inlineCode",{parentName:"a"},"user_menu.mustache"))," for more information. The lang menu has been moved to reside within the user menu."))),(0,i.kt)("p",null,"The primary navigation (the navbar) apart from the existing content will now display links to the Dashboard, My Courses, Site Admin and Course search, by default. You can still add items to the navbar via the ",(0,i.kt)("inlineCode",{parentName:"p"},"custom menu")," option. This will be displayed within the ",(0,i.kt)("strong",{parentName:"p"},"'More'")," menu."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Customising the primary navigation")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Not yet implemented but we are looking at allowing the full addition and removal of any of the primary navigation tabs in the boost theme config file."))),(0,i.kt)("h3",{id:"secondary-navigation"},"Secondary navigation"),(0,i.kt)("p",null,"The main content area shows tabs for secondary navigation with a maximum of 5 items being rendered in this ",(0,i.kt)("strong",{parentName:"p"},"'more'")," menu. A new UI component has been created to render menus like this. More information can be found in: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/moodle/moodle/blob/v4.0.0/lib/templates/moremenu.mustache"},(0,i.kt)("inlineCode",{parentName:"a"},"/lib/templates/moremenu.mustache"))),(0,i.kt)("h4",{id:"adding-items-to-the-navigation"},"Adding items to the navigation"),(0,i.kt)("p",null,"The secondary navigation pulls information mainly from the settings navigation node from each context. Any plugin that implements the existing navigation hooks will have their items added to the secondary navigation.\nExisting navigation hooks:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"{module}_extend_navigation"),(0,i.kt)("li",{parentName:"ul"},"{local}_extend_navigation"),(0,i.kt)("li",{parentName:"ul"},"{report}_report_extend_navigation"),(0,i.kt)("li",{parentName:"ul"},"{plugin}_extend_navigation_course"),(0,i.kt)("li",{parentName:"ul"},"{plugin}_extend_navigation_category_settings")),(0,i.kt)("h4",{id:"changing-the-order-of-tabs"},"Changing the order of tabs"),(0,i.kt)("p",null,"Apart from the previously mentioned functions, you can also create a custom secondary class as mentioned earlier. This will automatically be picked by getter and used to render the secondary nav within the activity. For example, ",(0,i.kt)("inlineCode",{parentName:"p"},"mod_assign/local/views/secondary"),"."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"This is currently only possible on an activity and block level."))),(0,i.kt)("h3",{id:"tertiary-navigation"},"Tertiary navigation"),(0,i.kt)("p",null,"Action buttons have been moved to the top of the page and we would encourage you to do the same.\nIf you have any buttons on an activity page that go to another page, or open a form (or similar), then we encourage you to move them from the body of your activity page to the top. All of the core activities have been updated to follow this pattern. Please take a look to see how you can format your activity in a similar fashion. There is no API here. You are welcome to create the buttons and display them as you wish in this top area."),(0,i.kt)("h3",{id:"new-api-functions"},"New API functions"),(0,i.kt)("h4",{id:"page-api"},"Page API"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Magic getters to fetch the primary and secondary navigation and the primary output."),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"secondarynav")," magic getter also checks whether a custom secondary class has been defined within the module's local\\views directory. Use this if you want to deviate from the standard secondary nav structure/order."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"set_secondarynav")," - Force override the secondary navigation class"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"set_secondary_navigation")," - Sets the ",(0,i.kt)("inlineCode",{parentName:"li"},"_hassecondarynavigation")," and optionally the ",(0,i.kt)("inlineCode",{parentName:"li"},"_hastablistsecondarynavigation")," to indicate whether a page should render the secondary navigation, and if the secondary navigation should be rendered and behave with a tablist ARIA role (as opposed to its default which is being rendered with a menubar ARIA role).")),(0,i.kt)("h4",{id:"navigation-library"},"Navigation library"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"set_show_in_secondary_navigation")," - whether or not a node should be displayed in the secondary nav. Accepts a single boolean argument"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"set_force_into_more_menu")," - whether or not to force a node into the ",(0,i.kt)("strong",{parentName:"li"},"'More'")," menu. Accepts a single boolean argument")),(0,i.kt)("h4",{id:"the-activity-header-class"},"The activity header class"),(0,i.kt)("p",null,"There is a new activity header class that handles the display of information common to activities. Third party activities are not required to explicitly output this information as part of rendering individual pages."),(0,i.kt)("p",null,"The common information that are currently handled by the class are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"title"),(0,i.kt)("li",{parentName:"ul"},"description"),(0,i.kt)("li",{parentName:"ul"},"completion information")),(0,i.kt)("p",null,"As part of the update it was required that the initial information to be displayed by the class be togglable at a theme and layout level. Taking this into account the following theme level configurable exists:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"activityheaderconfig")," - An array that currently only enforces ",(0,i.kt)("inlineCode",{parentName:"li"},"notitle")," but can be expanded in the future.")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Boost has this set as true by default ",(0,i.kt)("inlineCode",{parentName:"p"},"options"),"."))),(0,i.kt)("p",null,"The following layout level options that can be defined:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"noactivityheader")," - to remove the header in this specific layout."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"activityheader")," - An array that enforces the following options:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"notitle")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"nocompletion")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"nodescription"))))),(0,i.kt)("p",null,"The class has a page level getter which you can use to fetch the current version of the class. The base state is initialised within the constructor with the completion information only fetched when data is exported for the template."),(0,i.kt)("p",null,"The class has setters for the following variables which can be leveraged to modify the header for a particular page in the format ",(0,i.kt)("inlineCode",{parentName:"p"},"set_{variable_name}"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"hidecompletion"),(0,i.kt)("li",{parentName:"ul"},"description"),(0,i.kt)("li",{parentName:"ul"},"title")),(0,i.kt)("p",null,"Alternately, bulk operations can also be done by passing the above variables in an array to ",(0,i.kt)("inlineCode",{parentName:"p"},"set_attrs")," which in turn calls the setters."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Any updates to the ",(0,i.kt)("inlineCode",{parentName:"p"},"activityheader")," needs to be performed before the call to ",(0,i.kt)("inlineCode",{parentName:"p"},"$OUTPUT->header")))),(0,i.kt)("h5",{id:"theme-updates"},"Theme updates"),(0,i.kt)("p",null,"With the changes in boost to incorporate the primary and secondary navigation, third party themes would need to account for the following in their templates:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"To leverage the activity_header, it's data needs to be exported and included into the base template :"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"headercontent")," being the array element that contains the exported activity_header data")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-html"},"{{#headercontent}}\n   {{> core/activity_header}}\n{{#headercontent}}\n\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"It is recommended to transition towards the secondary/tertiary navigation hierarchy to reduce user cognitive load and with a logical separation of components"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Secondary navigation can be added to the templates by following the example ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/moodle/moodle/blob/master/theme/boost/templates/columns2.mustache#L64-L68"},"https://github.com/moodle/moodle/blob/master/theme/boost/templates/columns2.mustache#L64-L68")," This leverages the secondary navigation class to generate it's content."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Flat navigation classes have been marked for deprecation. Themes that leverage the flat_navigation will need to make the following changes in their plugins in order to use it"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Account for the additional changes ",(0,i.kt)("a",{parentName:"p",href:"#theme-changes"},"theme changes"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Indicate that they do not implement secondary navigation via the page's ",(0,i.kt)("inlineCode",{parentName:"p"},"set_secondary_navigation")," function. It is recommended to set this within the root layout file, for example, columns2")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Initialise the flat navigation by introducing the following in the root layout file (if not existent)"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-php"},"$nav = $PAGE->flatnav;\n$templatecontext['firstcollectionlabel'] = $nav->get_collectionlabel();\n"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"In order to reintroduce the settings cog in the templates, you can introduce the following:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<div id="region-main-settings-menu" class="d-print-none {{#hasblocks}}has-blocks{{/hasblocks}}">\n   <div> {{{ output.region_main_settings_menu }}} </div>\n</div>\n')))),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Accessibility notes")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The jump to ",(0,i.kt)("inlineCode",{parentName:"p"},"maincontent")," div is now rendered within the activity header when within an activity context."))),(0,i.kt)("h2",{id:"component-library"},"Component library"),(0,i.kt)("p",null,"Each Moodle installation now ships with a Moodle User Interface (UI) Component library, a documentation system used to describe all the Bootstrap components and the custom Moodle components. The component Library is a helper tool for developers when creating user interfaces, a testing tool for theme developers and a documentation tool for core developers. The ultimate goal of having a component library is to encourage developers to create consistent user interfaces to improve Moodle's overall user experience."),(0,i.kt)("p",null,"The library contains pages with documentation about User Interface components. It contains details on how to use the component, what variations are available and the JavaScript events / options are associated with the component."),(0,i.kt)("p",null,"When writing on these pages it is possible to render core mustache templates using some custom syntax like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-handlebars"},' {{< mustache template="core/notification_error" >}}\n {{< /mustache >}}\n')),(0,i.kt)("p",null,"You can also call core JavaScript or use HTML examples where the HTML code and the rendered result are visible in the Component Library. For more info visit the ",(0,i.kt)("a",{parentName:"p",href:"http://componentlibrary.moodle.com/admin/tool/componentlibrary/docspage.php/library/moodle-templates/"},"Moodle templates")," page or the ",(0,i.kt)("a",{parentName:"p",href:"http://componentlibrary.moodle.com/admin/tool/componentlibrary/docspage.php/library/moodle-javascript/"},"Moodle JavaScript")," page."),(0,i.kt)("p",null,'Each page in the library uses the current CSS from the default theme in your Moodle installation, if you have multiple themes installed and enabled the setting "Allow theme changes on url", the component library will have a theme selector option.'),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"A hosted version of the Component Library can be found at ",(0,i.kt)("a",{parentName:"p",href:"http://componentlibrary.moodle.com"},"http://componentlibrary.moodle.com"),"."))),(0,i.kt)("h3",{id:"enabling-the-component-library"},"Enabling the Component Library"),(0,i.kt)("p",null,"Component library pages are written in the markdown language. These pages need to be compiled to HTML pages before the Component Library is visible. To compile the pages the server running Moodle needs to have ",(0,i.kt)("a",{parentName:"p",href:"/general/development/tools/nodejs"},"nodeJS and Grunt tools"),"."),(0,i.kt)("p",null,"If your server meets all requirements you can enable the library running"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"}," $ npm install\n $ grunt componentlibrary\n")),(0,i.kt)("p",null,"Further installation instructions can be found in the Component Library itself."),(0,i.kt)("h3",{id:"documenting-new-ui-components"},"Documenting new UI Components"),(0,i.kt)("p",null,"There are no set rules for adding new pages in the component library yet. These rules will need to be written and adopted in the integration process for Moodle code."),(0,i.kt)("p",null,"As a guideline for making this rules consideration are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The component library is not about single use components, for example the Moodle grade book (a huge component with many custom features). Or about very common components like buttons, these are already covered by the Bootstrap section of the component library."),(0,i.kt)("li",{parentName:"ul"},"New features should be build keeping in mind the UI part needs to be customisable and if possible (and making sense) reusable. And example would be the new page drawers that we are introducing for the Navigation project. Or the custom primary navigation menus where overflowing items are pushed into a More section.")),(0,i.kt)("h2",{id:"theme-changes"},"Theme changes"),(0,i.kt)("h3",{id:"edit-switch"},"Edit switch"),(0,i.kt)("p",null,'On theme boost the "Turn editing on" and "Customise this page" buttons have been replaced by an edit switch in the top navbar. Theme Classic will keep using the old buttons. Child themes can choose to use the edit switch if the theme config.php is using this variable'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"$THEME->haseditswitch = true;\n")),(0,i.kt)("p",null,"The language menu, which used to be rendered in place of the custom menu has moved to the user dropdown when the user is logged in. If not logged in it will be placed next to the search / notification / messaging icon in the top navbar."),(0,i.kt)("h3",{id:"login-page"},"Login page"),(0,i.kt)("p",null,"The login page has been redesigned and allows the admin to configure a background image for the login page only in the theme settings page. This change is available in both Boost and Classic. The login page still has all the features with an improved layout."),(0,i.kt)("h3",{id:"the-page-footer"},"The page footer"),(0,i.kt)("p",null,"In large screens, the page footer button is only visible when clicking a help button at the bottom right of the screen."),(0,i.kt)("h3",{id:"user-initials-as-profile-picture-placeholder"},"User initials as profile picture placeholder"),(0,i.kt)("p",null,"If users do not upload a profile picture the user initials are displayed on a rounded gray background as a placeholder picture in the top navbar or any other page using a placeholder image. This change will be available in both Boost and Classic."),(0,i.kt)("p",null,"With the introduction of this placeholder image the full username will no longer be displayed in the top navbar."),(0,i.kt)("h3",{id:"removal-of-back-to-top-link"},"Removal of back to top link"),(0,i.kt)("p",null,'The "back to top" link will be removed for theme boost since the new course index reduced the dependence on page scrolling. Also, the new footer is positioned where this component used to be.'),(0,i.kt)("h3",{id:"styling-changes"},"Styling changes"),(0,i.kt)("p",null,"By default rounded edges will be used for UI components, for the page header and main content area the borders will be removed."),(0,i.kt)("h3",{id:"new-layout-page"},"New layout page"),(0,i.kt)("p",null,"Theme boost now uses the ",(0,i.kt)("inlineCode",{parentName:"p"},"drawers.php")," layout for the course index and blocks."),(0,i.kt)("h2",{id:"question-bank-changes"},"Question bank changes"),(0,i.kt)("p",null,"There was a big project to deliver ",(0,i.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Question_bank_improvements_for_Moodle_4.0"},"Question bank improvements for Moodle 4.0")," which added a new plugin type for adding features to the question banks, tracking the version history for each question as it is edited (question table has been split into ",(0,i.kt)("inlineCode",{parentName:"p"},"question"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"question_versions")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"question_bank_entries"),"), and tracking where each question is going to be used, with new tables ",(0,i.kt)("inlineCode",{parentName:"p"},"question_references")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"question_set_references"),". This work was done in Epic ",(0,i.kt)("a",{parentName:"p",href:"https://tracker.moodle.org/browse/MDL-70329"},"MDL-70329")," if you want to track down the details of any of the core changes."),(0,i.kt)("h3",{id:"question-type-plugins"},"Question type plugins"),(0,i.kt)("p",null,"Amazingly, we (Safat and colleagues at Catalyst AU) managed to implement this without breaking most question type plugins, with one important exception if your questions do shuffling like multiple choice does. See ",(0,i.kt)("a",{parentName:"p",href:"https://tracker.moodle.org/browse/MDL-74752"},"MDL-74752"),". There is a new method called ",(0,i.kt)("inlineCode",{parentName:"p"},"update_attempt_state_date_from_old_version")," which you may need to implement."),(0,i.kt)("p",null,"However, the changes to the question bank, and the other Moodle 4.0 changes, probably broke the Behat tests for your plugin. To help with fixing that, ",(0,i.kt)("a",{parentName:"p",href:"https://tracker.moodle.org/browse/MDL-74130"},"MDL-74130")," adds navigation to key question type pages (Preview and Edit for a question, and standard question bank pages like the bank itself, import and export) which should let you fix your test efficiently, and in a way that will work in all Moodle versions since 3.9."),(0,i.kt)("p",null,"The 'most' in the first paragraph here is because more advance question types may require more effort to fix. For example ",(0,i.kt)("inlineCode",{parentName:"p"},"qtype_combined")," which creates multi-part questions like the core ",(0,i.kt)("inlineCode",{parentName:"p"},"qtype_multianswer"),"; or ",(0,i.kt)("inlineCode",{parentName:"p"},"qtype_pmatch")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"qtype_stack"),", which store additional data - questions tests - alongside the question itself. How should that work with versioning?) But, if you have not done weird things like that, you are probably safe. If you find anything else that causes problems, please list it here."),(0,i.kt)("p",null,"The same thing should apply to question behaviour and question import/export format plugins: no significant changes required (probably just fixing the Behat tests because of the navigation changes)."),(0,i.kt)("h3",{id:"new-plugin-type-qbank-plugins"},"New plugin type: qbank plugins"),(0,i.kt)("p",null,"This is not something that will cause problems for people upgrading from 3.x. Rather, it is an exciting possibility you can explore once you have survived process of upgrading to 4.0. There is a whole new plugin type which you can create to add new features to the question bank. For example extra columns, new actions and bulk actions, and so on. See ",(0,i.kt)("a",{parentName:"p",href:"/docs/apis/plugintypes/qbank"},"Question bank plugins"),"."),(0,i.kt)("h3",{id:"activities-that-use-questions"},"Activities that use questions"),(0,i.kt)("p",null,"The probable bad news is if you have an activity module which uses questions. So far, the only activity which has been fixed is ",(0,i.kt)("inlineCode",{parentName:"p"},"mod_quiz")," in Moodle core, so we don't yet have a good picture of what fixes will be necessary in other activities. Work is about to start fixing ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/studentquiz/moodle-mod_studentquiz"},(0,i.kt)("inlineCode",{parentName:"a"},"mod_studentquiz")),", so watching that should give more clues. As we do that, we will try to update this section of this page. Other help writing the information required here would also be greatly appreciated."),(0,i.kt)("h2",{id:"the-course-format-system"},"The course format system"),(0,i.kt)("p",null,'Most of the logic for rendering and editing a course has been moved to a new subsystem called courseformat. The subsystem is located in "course/format" folder so it includes all the format plugins inside. The methods and modules which are distributed between the course and the course/format folders are now rearranged or refactored to be aligned with the current Moodle coding style.'),(0,i.kt)("h3",{id:"mandatory-renderer-in-course-formats"},"Mandatory renderer in course formats"),(0,i.kt)("p",null,"Now format plugins renderer is not optional anymore. Legacy formats without a renderer will get a deprecation message but it will continue working however, they should create a new renderer as soon as possible. The section-based format can do it by extending the provided ",(0,i.kt)("inlineCode",{parentName:"p"},"core_courseformat\\output\\section_renderer")," class which includes all the necessary methods."),(0,i.kt)("h3",{id:"new-format-base-class"},"New format base class"),(0,i.kt)("p",null,"The old ",(0,i.kt)("inlineCode",{parentName:"p"},"base_format")," class (which all plugins extend) is now renamed as ",(0,i.kt)("inlineCode",{parentName:"p"},"core_courseformat\\base"),". The new class provides all the functionally of the previous ",(0,i.kt)("inlineCode",{parentName:"p"},"base_format")," but it has been refactored to be used as a centralized source of truth for the course rendering. Legacy formats should extend the new class to avoid the deprecation message."),(0,i.kt)("p",null,"Now, the plugin format class provides information such as:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If the page is displaying a single or multiple section"),(0,i.kt)("li",{parentName:"ul"},"Give access to other related format objects like the modinfo, the course record, maximum number of sections..."),(0,i.kt)("li",{parentName:"ul"},"If the format is compatible with features like course index, reactive components, AJAX..."),(0,i.kt)("li",{parentName:"ul"},"Other format specifics like the page title, the default section name, default blocks...")),(0,i.kt)("p",null,"The format instance is now the main object output components will use to render a course (see next section for more information)."),(0,i.kt)("h3",{id:"new-course-output-classes-and-mustache-files"},"New course output classes and mustache files"),(0,i.kt)("p",null,"Traditionally, section-based course formats uses ",(0,i.kt)("inlineCode",{parentName:"p"},"print_single_section_page")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"print_multiple_section_page")," to render the course content. In Moodle 4.0 most of the course rendering methods are migrated to output components and mustache templates. The old methods will get deprecation messages if they use the old renderer methods."),(0,i.kt)("p",null,"This is an example of a format rendering a course:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"// Get the course format instance.\n$format = course_get_format($course);\n\n// Get the specific format renderer.\n$renderer = $format->get_renderer($PAGE);\n\nif (!empty($displaysection)) {\n    // Setup the format instance to display a single section.\n    $format->set_section_number($displaysection);\n}\n\n// Create the output instance and render it.\n$outputclass = $format->get_output_classname('content');\n$widget = new $outputclass($format);\n\necho $renderer->render($widget);\n")),(0,i.kt)("p",null,"Another important update on course rendering is that now all course structure is rendered using mustache templates instead of the original ",(0,i.kt)("inlineCode",{parentName:"p"},"html_writer")," methods. Now themes are able to override the course format by providing alternative versions of the mustache files. All core course templates are located in ",(0,i.kt)("inlineCode",{parentName:"p"},"course/format/templates"),"."),(0,i.kt)("p",null,"All course format output classes implements the new ",(0,i.kt)("inlineCode",{parentName:"p"},"named_templatable")," interface, which allows the class to define its own template path using the ",(0,i.kt)("inlineCode",{parentName:"p"},"get_template_name")," method. This new interface in combination with ",(0,i.kt)("a",{parentName:"p",href:"./guides/templates#blocks"},"mustache blocks")," allows the format plugins to provide alternative templates to render the course."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Migrating 3.11 course formats doc")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"All the new output classes and a guide on how to migrate the current third-party plugins can be found in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/apis/plugintypes/format/migration"},"Migrating 3.11 formats")," page."))),(0,i.kt)("h3",{id:"course-editor-javascript-modules-and-frontend-components"},"Course editor JavaScript modules and frontend components"),(0,i.kt)("p",null,"The majority of the JavaScript logic related to the course editing is replaced by AMD modules. Because this is a major change in the way courses are edited and rendered, by default format plugins will continue using the previous YUI modules for now. However, formats can start using the new libraries overriding the ",(0,i.kt)("inlineCode",{parentName:"p"},"$format->supports_components()")," method."),(0,i.kt)("p",null,"Some Moodle 4.0 new features are only available for courses using the new editor library:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Edit the course via the course index"),(0,i.kt)("li",{parentName:"ul"},"Creating sections without reloading the course page"),(0,i.kt)("li",{parentName:"ul"},"The new move section/activity modal"),(0,i.kt)("li",{parentName:"ul"},"Native browser drag&drop implementation")),(0,i.kt)("p",null,"The new course editor uses a component-based reactive pattern to keep track of the course changes. The pattern highlights are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The main AMD module ",(0,i.kt)("inlineCode",{parentName:"li"},"core_crouseformat\\courseeditor")," maintains a data structure called state."),(0,i.kt)("li",{parentName:"ul"},"Each UI element is implemented as a Component that observes the course state data and reacts to any data change"),(0,i.kt)("li",{parentName:"ul"},"When any reactive component needs to modify the course, it asks the course editor to execute a mutation. Mutations encapsulate all web services calls and alter the course state data.")),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Reactive library doc")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The reactive library documentation, as well as the format plugin migration guide, can be found in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/javascript/reactive"},"Moodle 3.11 vs 4.0 course editor architecture")," page."))),(0,i.kt)("h3",{id:"other-course-related-40-changes"},"Other course related 4.0 changes"),(0,i.kt)("p",null,"Two new web services have been added:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"core_courseformat_get_state"),": user by the new JavaScript course editor to get the current course state data (containing the list of sections, activities, and other course-related data)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"core_courseformat_update_course"),": to alter the current course content. Each call returns the parts of the course state altered by the action")),(0,i.kt)("h2",{id:"behat-changes"},"Behat changes"),(0,i.kt)("h3",{id:"new-steps"},"New steps"),(0,i.kt)("p",null,"Moodle 4.0 introduces some new behat steps."),(0,i.kt)("p",null,"Sometimes you want to create a bulk number of activities. In that case you can use:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},":count :entitytype exist with the following data:\n")),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'Given 100 "mod_lti > tool types" exist with the following data:\n  |name        |Test tool [](count)                  |\n  |description |Example description [](count)        |\n  |baseurl     |https://www.example.com/tool[](count)|\n')),(0,i.kt)("p",null,"Dynamic (AJAX) tabs is a new feature contributed to Moodle 4.0 by the Workplace team (",(0,i.kt)("a",{parentName:"p",href:"https://tracker.moodle.org/browse/MDL-71943"},"MDL-71943"),"). You can use the following step to navigate between the tabs."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I click on the "tab title" dynamic tab\n')),(0,i.kt)("p",null,"To make sure that edit mode is (or is not) available on the current page, the following steps can be used."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},"And edit mode should be available on the current page\nAnd edit mode should not be available on the current page\n")),(0,i.kt)("p",null,"There are new aliases for the existing steps ",(0,i.kt)("inlineCode",{parentName:"p"},"I turn editing mode on")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"I turn editing mode off"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},"And I switch editing mode on\nAnd I switch editing mode off\n")),(0,i.kt)("p",null,"In addition to the existing step to go to a course with editing mode on, we now have the following step to do the same but with editing mode being off."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I am on "course full name" course homepage with editing mode off\n')),(0,i.kt)("p",null,"The following step is similar to the old ",(0,i.kt)("inlineCode",{parentName:"p"},'following "link string" should download between "min bytes" and "max bytes" bytes')," step, with more flexibility."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And following "element string" "element type" in the "container string" "container type" should download between "min bytes" and "max bytes" bytes\n')),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And following "Download" "link" in the "Starter" "table_row" should download between "0" and "5000" bytes\n')),(0,i.kt)("p",null,"The following step can be used to hover the mouse over the trigger area."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I hover over the "element string" "element type" in the "container string" "container type"\n')),(0,i.kt)("p",null,"The following step enables an installed plugin."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I enable "plugin name" "plugin type" plugin\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I enable "course_summary" "block" plugin\n')))),(0,i.kt)("p",null,"The following is a special variation of ",(0,i.kt)("inlineCode",{parentName:"p"},'I click on "<page name>" "link" in the "page" "region"'),". It first checks to see if we are on the given page via the breadcrumb. If not we then attempt to follow the link name given."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I follow the breadcrumb "page name"\n')),(0,i.kt)("p",null,"You can use the following step to ensure a node is active in the navbar."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I should see "Node" is active in navigation\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I should see "My courses" is active in navigation\n')))),(0,i.kt)("p",null,"The following step can be used to navigate to a given node in the primary navigation."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I select "Node" from primary navigation\n')),(0,i.kt)("p",null,"The following steps are to check whether an item exists in the user menu or not."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And "item text" "selector type" should exist in the user menu\nAnd "item text" "selector type" should not exist in the user menu\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And "Language" "link" should exist in the user menu\n')))),(0,i.kt)("p",null,"The following steps are to check if a submenu of the user menu is shown, and if an item exists or does not exist in a given user submenu."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I should see "submenu name" user submenu\nAnd "item text" "selector type" should exist in the "submenu name" user submenu\nAnd "item text" "selector type" should not exist in the "submenu name" user submenu\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'When I follow "Language" in the user menu\nThen I should see "Language selector" user submenu\nAnd "English &lrm;(en)&lrm;" "link" should exist in the "Language selector" user submenu\nAnd "English (pirate) &lrm;(en_ar)&lrm;" "link" should not exist in the "Language selector" user submenu\n')))),(0,i.kt)("p",null,"To add enrolment methods to courses you can use the following new step. The data that you provide in the next lines are used to fill the enrolment method form."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I add "enrolment method" in "course identifier" with:\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'When I add "Self enrolment" enrolment method in "Course 1" with:\n  | Custom instance name     | Test student enrolment |\n  | Enrolment key            | moodle_rules           |\n  | Use group enrolment keys | Yes                    |\n')))),(0,i.kt)("p",null,"There are 3 new steps specific to the calendar component. These steps can be used to hover over a day in the mini-calendar or the full calendar."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I hover over day "day of month" of this month in the full calendar page\nAnd I hover over day "day of month" of this month in the mini-calendar block\nAnd I hover over today in the mini-calendar block\n')),(0,i.kt)("p",null,'Some new steps are added to question bank to be able to add comment to questions, verify the existence of a comment, and deleting comments form questions. Please note that the steps for adding comments only write the comment text in the comment field. You still need to click on the "Add comment" button to save the comment.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I add "comment text" comment to question\nAnd I add "comment text" comment to question preview\nAnd I delete "comment text" comment from question\nAnd I delete "comment text" comment from question preview\nAnd I should see "number of comments" on the comments column\nAnd I click "number of comments" on the row on the comments column\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I navigate to "Question bank" in current page administration\nAnd I should see "0" on the comments column\nAnd I click "0" on the row on the comments column\nAnd I add "test comment 01" comment to question\nAnd I click on "Add comment" "button" in the ".modal-dialog" "css_element"\nAnd I click on "Close" "button" in the ".modal-dialog" "css_element"\nAnd I should see "1" on the comments column\nAnd I click "1" on the row on the comments column\nAnd I delete "test comment 01" comment from question\n')))),(0,i.kt)("p",null,"Similar to the steps for comments, the following steps are to verify the number of a question's usage and to click on it in order to open the question usage modal."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I should see "usage count" on the usage column\nAnd I click "usage count" on the usage column\n')),(0,i.kt)("p",null,"The following new steps are related to bulk actions in the question bank UI."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I click on question bulk action "action"\nAnd I should see question bulk action "action"\nAnd I should not see question bulk action "action"\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I click on "First question" "checkbox"\nAnd I click on "Second question" "checkbox"\nAnd I click on "With selected" "button"\nAnd I should see question bulk action "deleteselected"\nAnd I click on question bulk action "deleteselected"\nAnd I click on "Delete" "button" in the "Confirm" "dialogue"\n')))),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://docs.moodle.org/en/Report_builder"},"Report builder")," is a new feature contributed to Moodle 4.0 by the Workplace team. The following new step is added to Moodle 4.0 to select an action from the action menu in the list of custom reports table."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I press "action" action in the "report name" report row\n')),(0,i.kt)("p",null,"There's another step related to the report builder to set a column's aggregation in the report editor."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I set the "column title" column aggregation to "aggregation method"\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I set the "First name" column aggregation to "Comma separated values"\n')))),(0,i.kt)("p",null,"The following step needs to be used in scenarios that involve testing BigBlueButton. For this to work, you need to have a ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/moodlehq/bigbluebutton_mock"},"BigBlueButton Mock API Server")," and set ",(0,i.kt)("inlineCode",{parentName:"p"},"TEST_MOD_BIGBLUEBUTTONBN_MOCK_SERVER")," to point to that in config.php."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},"And a BigBlueButton mock server is configured\n")),(0,i.kt)("p",null,"The following step replicates receiving a callback from the BigBlueButton server indicating the recordings for meetings are ready for viewing."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},"And the BigBlueButtonBN server has sent recording ready notifications\n")),(0,i.kt)("p",null,"The following steps are specific to the lesson activity."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},'In 4.0, some links (such as the "edit" and the "grade essays" links) are replaced by buttons, so you need to update your old steps with the new ones.'))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},"And I edit the lesson\n")),(0,i.kt)("p",null,"A new step is added to be used in lesson activities to edit them. This step navigates the user to the lesson edit page."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},"And I grade lesson essays\n")),(0,i.kt)("p",null,'It\'s a new step to go to the "Grade essays" page of the lesson we are currently in.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I select edit type "edit type"\n')),(0,i.kt)("p",null,'Select the lesson edit type when we are in the the lesson\'s edit page. "edit type" can either be "Collapsed" or "Expanded".'),(0,i.kt)("p",null,"The following new step can be used to navigate to the exports page in the course gradebook and select the specified export type from the grade exports navigation selector."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I navigate to "export option" export page in the course gradebook\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I navigate to "XML file" export page in the course gradebook\n')))),(0,i.kt)("p",null,"Similarly, there's a new step to navigate to the imports page in the course gradebook and select the specified import type from the grade imports navigation selector."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I navigate to "import option" import page in the course gradebook\n')),(0,i.kt)("h3",{id:"boost-steps"},"Boost steps"),(0,i.kt)("p",null,"In addition to the steps listed in the previous section, there are also some Boost specific steps coming with Moodle 4.0. These steps only work in Boost or Boost child themes, so you need to make sure they are not used in scenarios that may be run by non-Boost themes."),(0,i.kt)("p",null,"The following step checks whether a node is active in the secondary navigation."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},"And I should see :name is active in secondary navigation\n")),(0,i.kt)("p",null,"The Boost theme shows the language selector menu in the primary navigation when not logged in, and within the user menu when logged in. The following steps are to check if the primary navigation includes the language selector menu."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},"And language selector menu should exist in the navbar\nAnd language selector menu should not exist in the navbar\n")),(0,i.kt)("p",null,"And the following steps can be used to check whether an item exists in the language selector menu in the Boost theme."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And "item text" "selector type" should exist in the language selector menu\nAnd "item text" "selector type" should not exist in the language selector menu\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"For example:")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And "English &lrm;(en)&lrm;" "link" should exist in the language selector menu\n')))),(0,i.kt)("h3",{id:"modified-steps"},"Modified steps"),(0,i.kt)("p",null,"The step ",(0,i.kt)("inlineCode",{parentName:"p"},'I change the (window|viewport) size to "size"')," now supports 2 new values for the size argument. The size argument now accepts ",(0,i.kt)("inlineCode",{parentName:"p"},"mobile")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"tablet")," values in addition to ",(0,i.kt)("inlineCode",{parentName:"p"},"small"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"medium")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"large"),"."),(0,i.kt)("h3",{id:"removed-steps"},"Removed steps"),(0,i.kt)("p",null,"Some behat steps are removed or replaced with new steps."),(0,i.kt)("p",null,"As a result of some design changes, hidden or restricted activities are no longer dimmed. Therefore the step"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And "Activity or resource name" activity should be dimmed\n')),(0,i.kt)("p",null,"is now removed. Depending on what you were using that step for, you may be able to use these steps:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And "Label name" label should be hidden\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And "Activity or resource name" activity should be hidden\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I should see "Activity or resource name"\nAnd "Activity or resource name" "link" should not exist in the "region-main" "region"\n')),(0,i.kt)("h3",{id:"other-things-to-consider"},"Other things to consider"),(0,i.kt)("p",null,"To make behat tests more readable and easy to maintain, it is recommended to use the most direct steps to get what the test needs. It is highly recommended to use"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},' I am on the "Activity name" "[modname] activity" page\n')),(0,i.kt)("p",null,"or"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},' I am on the "Activity name" "[modname] activity" page logged in as "user"\ninstead of navigating to the activity via\n I am on "Course" course homepage\n I follow "Activity name"\n')),(0,i.kt)("p",null,"Now that course index is integrated these behat steps will fail using Boost theme:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},' I am on "Course" course homepage\n I follow "Activity name"\n')),(0,i.kt)("p",null,'The reason for it is that the drawer used in Boost is hiding the course index. So when the test is trying to follow an "Activity name" link, it finds two different links:'),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"one in the course index"),(0,i.kt)("li",{parentName:"ul"},"another one in the course main content.")),(0,i.kt)("p",null,"But the first one, the one in the course index, is hidden by the drawer, and the test fails."),(0,i.kt)("p",null,"However the recommended behat steps"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},' I am on the "Activity name" "[modname] activity" page\n')),(0,i.kt)("p",null,"or"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},' I am on the "Activity name" "[modname] activity" page logged in as "user"\n')),(0,i.kt)("p",null,"Old behat steps that may now fail can be updated to the new steps. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},' And I am on the "Test assignment name" "assign activity" page logged in as teacher1\n')),(0,i.kt)("p",null,"instead of:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},' When I log in as "teacher1"\n And I am on "Course" course homepage\n And I follow "Test assignment name"\n')),(0,i.kt)("p",null,"Or for settings, instead of:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I follow "Test choice name"\nAnd I navigate to "Edit settings" in current page administration\n')),(0,i.kt)("p",null,"Use:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-gherkin"},'And I am on the "Test choice name" "choice activity editing" page\n')),(0,i.kt)("p",null,"There are also similar stream-lined navigation steps for accessing question bank pages. See ",(0,i.kt)("a",{parentName:"p",href:"https://tracker.moodle.org/browse/MDL-74130"},"MDL-74130"),"."),(0,i.kt)("h2",{id:"other"},"Other"),(0,i.kt)("h3",{id:"core-plugins-review"},"Core plugins review"),(0,i.kt)("p",null,"A few plugins from core Moodle LMS which are no longer or hardly used have been removed and, if appropriate, added to the Moodle plugins directory."),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"More information about this project, the list of plugins to be removed and the process to follow for keeping them before upgrading to 4.0 can be found in the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Core_plugins_review"},"Core plugins review")," project page."))),(0,i.kt)("h3",{id:"core-blocks-cleanup"},"Core blocks cleanup"),(0,i.kt)("p",null,'In the "Add a block" menu, the list of blocks was really long. A few changes have been done to reduce this list.'),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"More information about this project can be found in the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Add_a_block_cleanup"},"Add a block cleanup")," project page."))),(0,i.kt)("h3",{id:"site-admin-presets-plugin"},"Site admin presets plugin"),(0,i.kt)("p",null,"The third-party plugin ",(0,i.kt)("a",{parentName:"p",href:"https://moodle.org/plugins/block_admin_presets"},"Admin presets"),", created by David Monlla\xf3 and maintained by developers from ",(0,i.kt)("a",{parentName:"p",href:"https://pimenko.com/"},"Pimenko"),' has been adapted and integrated into Moodle 4.0. It stores settings and plugins status (enabled/disabled) in what\'s called "presets" to let admins quickly switch between different configurations.'),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"More information about this project can be found in the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Site_admin_presets"},"Site admin presets")," project page."))),(0,i.kt)("h3",{id:"javascript-browser-support-changes"},"JavaScript browser support changes"),(0,i.kt)("p",null,"From Moodle 4.0, Internet Explorer is no longer supported. See ",(0,i.kt)("a",{parentName:"p",href:"https://tracker.moodle.org/browse/MDL-73915"},"MDL-73915")," and ",(0,i.kt)("a",{parentName:"p",href:"https://tracker.moodle.org/browse/MDLSITE-6109"},"MDLSITE-6109")," for further information on this change."),(0,i.kt)("p",null,"This change means that changes built on 4.0 onwards (including the master branch) will be different to older versions of Moodle."),(0,i.kt)("p",null,"For plugin developers supporting multiple versions of Moodle using a single plugin version, the compiled JavaScript files are backwards compatible and will ",(0,i.kt)("em",{parentName:"p"},"work")," on all supported versions, however if you run the ",(0,i.kt)("inlineCode",{parentName:"p"},"grunt")," command on multiple versions you will see unbuilt changes. Running grunt on all versions of Moodle is not necessary and this check can be safely disabled for Moodle versions 3.9 - 4.0, as long as only at least you run ",(0,i.kt)("inlineCode",{parentName:"p"},"grunt")," against at least one version of Moodle."),(0,i.kt)("p",null,"If you need to support Internet Explorer and do not wish to fork your plugin for Moodle 4.0 onwards, then it is recommended that you run ",(0,i.kt)("inlineCode",{parentName:"p"},"grunt")," on an older version of Moodle."),(0,i.kt)("h3",{id:"the-course-index-element"},"The course index element"),(0,i.kt)("p",null,"The new course index feature can be themed using a set of scss variables. Use them to change the look and feel instead of adding custom CSS"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," /theme/boost/scss/moodle/courseindex.scss\n")),(0,i.kt)("p",null,"With the introduction of the course index component, the previous and next links shown underneath each activity are no longer needed and they will be removed."),(0,i.kt)("h3",{id:"activity-icons"},"Activity icons"),(0,i.kt)("p",null,"The icons used for activities have been redesigned and updated for all core moodle activities."),(0,i.kt)("p",null,"When viewing the new icons in a file manager, for example for the quiz activity, you will see a simple black monochrome icon with a transparent background."),(0,i.kt)("p",null,"On the course page, or in the activity chooser, the icon will display as a white icon on a coloured background. Styling of the icons on the course page is controlled by the CSS in ",(0,i.kt)("inlineCode",{parentName:"p"},"theme/boost/scss/moodle/icons.scss"),"."),(0,i.kt)("p",null,"The background colour for activity icons is set using a new variable in function ",(0,i.kt)("inlineCode",{parentName:"p"},"[modname]_supports()"),". The quiz activity is of type assessment, so in function ",(0,i.kt)("inlineCode",{parentName:"p"},"quiz_supports()")," there is a new line defining the purpose:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"}," case FEATURE_MOD_PURPOSE: return MOD_PURPOSE_ASSESSMENT;\n")),(0,i.kt)("p",null,"Available purposes are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"MOD_PURPOSE_COMMUNICATION"),(0,i.kt)("li",{parentName:"ul"},"MOD_PURPOSE_ASSESSMENT"),(0,i.kt)("li",{parentName:"ul"},"MOD_PURPOSE_COLLABORATION"),(0,i.kt)("li",{parentName:"ul"},"MOD_PURPOSE_CONTENT"),(0,i.kt)("li",{parentName:"ul"},"MOD_PURPOSE_ADMINISTRATION"),(0,i.kt)("li",{parentName:"ul"},"MOD_PURPOSE_INTERFACE")),(0,i.kt)("p",null,"The background colours linked to these purposes are set in ",(0,i.kt)("inlineCode",{parentName:"p"},"theme/boost/scss/moodle/variables.scss")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-scss"},' $activity-icon-colors: map-merge(\n     (\n         "administration": #5d63f6,\n         "assessment": #eb66a2,\n         "collaboration": #f7634d,\n         "communication": #11a676,\n         "content": #399be2,\n         "interface": #a378ff\n     ),\n     $activity-icon-colors\n );\n')),(0,i.kt)("p",null,"If activity plugins do not define ",(0,i.kt)("inlineCode",{parentName:"p"},"FEATURE_MOD_PURPOSE")," the activity icon will be rendered against a light grey background. There is no requirement to define the purpose of activity plugins, it will only affect the icon styling."),(0,i.kt)("p",null,"Plugins implementing the variable ",(0,i.kt)("inlineCode",{parentName:"p"},"FEATURE_MOD_PURPOSE")," are only supported on Moodle 4.0 and newer."),(0,i.kt)("p",null,"Customising the activity icon can be done in an alternative way. For example using the ",(0,i.kt)("inlineCode",{parentName:"p"},"styles.css")," in ",(0,i.kt)("inlineCode",{parentName:"p"},"mod/[pluginname/styles.css")),(0,i.kt)("p",null,"In the example below the activity plugin developer chooses to keep the coloured icon for the activity and render it as large as the coloured background on the core activities"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-css"}," .modicon_subcourse.activityiconcontainer {\n     background-color: transparent;\n     padding: 0;\n }\n\n .modicon_subcourse.activityiconcontainer img {\n     width: 50px;\n     height: 50px;\n }\n")),(0,i.kt)("p",null,"To customize all icon colours use this scss array and add it to the 'Raw initial SCSS' in the theme Boost advanced settings page. The complete array of icon background colours can be overridden using the 'Raw initial SCSS' in the theme settings page. The example below changes the colours of each activity type."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-scss"},' $activity-icon-colors: (\n     "administration": #5D63F6,\n     "assessment": #11A676,\n     "collaboration": #EB66A2,\n     "communication": #F7634D,\n     "content": #399BE2,\n     "interface": #A378FF\n )\n')),(0,i.kt)("h2",{id:"im-a-developer-what-do-i-need-to-know"},"I'm a developer, what do I need to know?"),(0,i.kt)("p",null,"This section is a quick checklist of the areas in this document that you should consult when updating your plugin."),(0,i.kt)("h3",{id:"modules"},"Modules"),(0,i.kt)("p",null,"If you are a module developer (activity / resources) then you need to review the following updates and changes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If using settings, reformat to work with the secondary navigation. We have significantly changed the way that settings are shown. Settings added to the course and activity administration branch of the navigation are now by default shown in the secondary navigation. You will most likely find them in the more section of the secondary navigation. Please avoid creating settings in containers (a parent navigation node with children). These settings will still be shown, but this goes against the pattern that we are trying to establish for navigation around the site. If you have a lot of settings, consider creating a specific page to handle your additional settings.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"The order of the items in the secondary navigation may not be to your liking. This can be changed. See ",(0,i.kt)("a",{parentName:"li",href:"#changing-the-order-of-tabs"},"changing the order of tabs"),"."))),(0,i.kt)("li",{parentName:"ul"},"Update my behat tests to use new steps for site navigation. See ",(0,i.kt)("a",{parentName:"li",href:"#behat-changes"},"new behat steps"),"."),(0,i.kt)("li",{parentName:"ul"},"Update my module to use the new activity_header API. See ",(0,i.kt)("a",{parentName:"li",href:"#the-activity-header-class"},"the activity header"),"."),(0,i.kt)("li",{parentName:"ul"},"Update my pages to make it work with the general format of the tertiary navigation. See ",(0,i.kt)("a",{parentName:"li",href:"#tertiary-navigation"},"the tertiary navigation"),"."),(0,i.kt)("li",{parentName:"ul"},"Update my activity icon to use the API and set a purpose. See ",(0,i.kt)("a",{parentName:"li",href:"#activity-icons"},"activity icons"),".")),(0,i.kt)("h3",{id:"themes"},"Themes"),(0,i.kt)("p",null,"If you are a theme developer then you may want to consider the following:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Take a look at the ",(0,i.kt)("a",{parentName:"li",href:"#navigation-changes"},"new navigation")," and decide if you want to incorporate this into your theme.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"A new layout (",(0,i.kt)("a",{parentName:"li",href:"#new-layout-page"},"drawers"),")"),(0,i.kt)("li",{parentName:"ul"},"An ",(0,i.kt)("a",{parentName:"li",href:"#edit-switch"},"edit switch")),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{parentName:"li",href:"#the-course-index-element"},"course index")))),(0,i.kt)("li",{parentName:"ul"},"Use of the flat nav"),(0,i.kt)("li",{parentName:"ul"},"New Site administration page and layout"),(0,i.kt)("li",{parentName:"ul"},"Course settings and how they are displayed")),(0,i.kt)("h3",{id:"course-format"},"Course format"),(0,i.kt)("p",null,"There have been a lot of changes made to the course format. Most in the process of moving the course format away from using the old rendering system and towards templates.\nWe recommend the following sections be read carefully:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"#the-course-format-system"},"The course format"),". There have been a lot of deprecations and reading this section is critical in understanding the changes made."),(0,i.kt)("li",{parentName:"ol"},"Consider moving the rendering of your content over to the ",(0,i.kt)("a",{parentName:"li",href:"./guides/templates"},"template system"),".")),(0,i.kt)("h3",{id:"other-plugins"},"Other plugins"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Are you adding settings? See the ",(0,i.kt)("a",{parentName:"li",href:"#adding-items-to-the-navigation"},"secondary nav")," for adding items to this navigation bar."),(0,i.kt)("li",{parentName:"ol"},"Have a look at ",(0,i.kt)("a",{parentName:"li",href:"#secondary-navigation"},"secondary")," and ",(0,i.kt)("a",{parentName:"li",href:"#tertiary-navigation"},"tertiary")," navigation changes in general if you have a plugin that has multiple pages to navigate around."),(0,i.kt)("li",{parentName:"ol"},"Do you have behat tests? Check the new ",(0,i.kt)("a",{parentName:"li",href:"#behat-changes"},"behat changes"),".")))}u.isMDXComponent=!0}}]);