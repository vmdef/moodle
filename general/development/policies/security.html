<!doctype html>
<html lang="en-AU" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-general docs-doc-id-development/policies/security/index">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L9EE8RW5B1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-L9EE8RW5B1",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Moodle Developer Resources" href="/devdocs/opensearch.xml">


<link rel="icon" href="/devdocs/img/icons/orange_m.svg">
<link rel="manifest" href="/devdocs/manifest.json">
<meta name="theme-color" content="rgb(208, 99, 0)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/devdocs/img/icons/maskable_icon.png">
<link rel="mask-icon" href="/devdocs/img/icons/maskable_icon.png" color="rgb(208, 99, 0)">
<meta name="msapplication-TileImage" content="/devdocs/img/icons/maskable_icon.png">
<meta name="msapplication-TileColor" content="#000"><title data-rh="true">Security | Moodle Developer Resources</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://moodledev.io/devdocs/general/development/policies/security"><meta data-rh="true" name="docusaurus_locale" content="en-AU"><meta data-rh="true" name="docsearch:language" content="en-AU"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-general-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-general-current"><meta data-rh="true" property="og:title" content="Security | Moodle Developer Resources"><meta data-rh="true" name="description" content="This page describes how to write secure Moodle code that is not vulnerable to anything that evil people may try to throw at it."><meta data-rh="true" property="og:description" content="This page describes how to write secure Moodle code that is not vulnerable to anything that evil people may try to throw at it."><link data-rh="true" rel="icon" href="/devdocs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://moodledev.io/devdocs/general/development/policies/security"><link data-rh="true" rel="alternate" href="https://moodledev.io/devdocs/general/development/policies/security" hreflang="en-AU"><link data-rh="true" rel="alternate" href="https://moodledev.io/devdocs/general/development/policies/security" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NNUY2D5GV2-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/devdocs/assets/css/styles.294a7229.css">
<link rel="preload" href="/devdocs/assets/js/runtime~main.108433aa.js" as="script">
<link rel="preload" href="/devdocs/assets/js/main.2dbacd86.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/devdocs/"><div class="navbar__logo"><img src="/devdocs/img/Moodle.svg" alt="Moodle Developer Resources" class="themedImage_ToTc themedImage--light_HNdA" height="35px" width="138px"><img src="/devdocs/img/Moodle.svg" alt="Moodle Developer Resources" class="themedImage_ToTc themedImage--dark_i4oU" height="35px" width="138px"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/devdocs/docs">Guides</a><a class="navbar__item navbar__link" href="/devdocs/general/community/contribute">Community</a><a class="navbar__item navbar__link" href="/devdocs/general/development/gettingstarted">Coding</a><a class="navbar__item navbar__link" href="/devdocs/general/development/process">Process</a></div><div class="navbar__items navbar__items--right"><div class="wrapper_Jz6K"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/devdocs/general/development/gettingstarted">Getting started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/devdocs/general/development/policies">Policies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Policies&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/accessibility">Accessibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/backporting">Backporting</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/devdocs/general/development/policies/codingstyle">Coding style</a><button aria-label="Toggle the collapsible sidebar category &#x27;Coding style&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/codingstyle-moodleapp">Moodle App Coding style</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/component-communication">Component Communication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/deprecation">Deprecation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/designing-usable-forms">Designing usable forms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/naming">Naming conventions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/devdocs/general/development/policies/security">Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Security&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/unauthenticated-access">Unauthenticated access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/unauthorised-access">Unauthorised access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/crosssite-request-forgery">Cross-site request forgery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/crosssite-scripting">Cross-site scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/sql-injection">SQL injection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/commandline-injection">Command-line injection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/dataloss">Data-loss</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/info-leakage">Information leakage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/configinfo-leakage">Configuration leakage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/session-fixation">Session fixation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/dos">Denial of service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/bruteforcing-login">Brute-forcing login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/insecure-config">Insecure configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/bufferoverruns">Buffer overruns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/devdocs/general/development/policies/security/socialengineering">Social engineering</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/devdocs/general/development/tools">Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/devdocs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/devdocs/general/development/policies"><span itemprop="name">Policies</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Security</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Security</h1></header><p>This page describes how to write secure Moodle code that is not vulnerable to anything that evil people may try to throw at it.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Page organisation</h5></div><div class="admonition-content"><p>The page is organised around the <a href="#common-types-of-security-vulnerability">common types of security vulnerability</a>. For each one, it explains:</p><ol><li>what the danger is,</li><li>how Moodle is designed to avoid the problem,</li><li>what you need to do as a Moodle developer to keep your code secure, and</li><li>what you can do as an administrator, to make your Moodle more secure.</li></ol><p>The explanation of each vulnerability is on a separate page, linked to in the list below.</p></div></div><p>This page also summarises all the key guidelines.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-of-web-applications">Security of web applications<a class="hash-link" href="#security-of-web-applications" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure-web-app-requirements">Secure web app requirements<a class="hash-link" href="#secure-web-app-requirements" title="Direct link to heading">​</a></h3><p>Some companies require the maximum level of security for web applications. You can often see similar general recommendations:</p><ul><li>separate administration backend</li><li>no sensitive information stored in web application</li><li>communication has to be encrypted using SSL</li><li>log all user actions</li><li>server applications have to be completely separated</li><li>no files uploaded by users on server</li><li>no rich text entered by users on server (limited plain text only)</li><li>validate user identity and actions via separate channel</li><li>always keep every software up-to-date</li><li>no 3rd party browser extensions recommended</li><li>use only one web page, do not open multiple windows with different sites, close/open browser before and after using the secure app</li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p><strong>Web-based banking systems</strong> are the best examples of these secure web applications. Security is the top-most priority here, security incidents may cost money - either the customer, bank or insurance company, the public image of the institution may be damaged too. Limiting factors may be the cost of application development, maintenance and usability but also the cost of communication via the alternative channels.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="balanced-security">Balanced security<a class="hash-link" href="#balanced-security" title="Direct link to heading">​</a></h3><p>As you can see, many web applications today violate the security design rules. For example, web-based mail systems have to accept rich text messages with file attachments, mail messages often contain very sensitive information. In fact, the Web 2.0 idea goes directly against the security design rules, everybody is submitting content - only app designer/administrator should be adding trusted content.</p><p>When designing web applications we have to find out what our users are supposed to be doing and then find some reasonable balance between features and security.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="moodle-security-design">Moodle security design<a class="hash-link" href="#moodle-security-design" title="Direct link to heading">​</a></h2><p>The security of web application depends on the intended use and features available for each type of user.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="types-of-users">Types of users<a class="hash-link" href="#types-of-users" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="administrators">Administrators<a class="hash-link" href="#administrators" title="Direct link to heading">​</a></h4><p>Administrators have following privileges:</p><ul><li>Change all settings</li><li>Create courses</li><li>Access all courses</li><li>Modify language packs</li><li>Modify all users</li></ul><p>Indirectly administrators are allowed to execute shell and PHP code. Moodle administrators may be partially restricted by hardcoding settings in config.php.
Low level server administrators can not be restricted because they can read content of PHP files and may modify them.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>All administrators have to be fully trusted.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="teachers">Teachers<a class="hash-link" href="#teachers" title="Direct link to heading">​</a></h4><p>Teachers are usually creating course content, enrolling students and teaching. They usually need following privileges:</p><ul><li>Upload files and submit html texts</li><li>Create and manage activities</li><li>Access student grades and other personal information</li></ul><p>Uploading of files with JavaScript, flash and other scripted is often considered to be a security risk. Unfortunately we can not remove these risks from teacher roles because even basic SCORM packages consist of HTML and JavaScript which needs to use user session.</p><p>Browser trusts everything coming from one server, it does not know anything about our courses or origin of data. Once the file is uploaded to server it becomes part of the server application. It is not possible to differentiate between wanted and unwanted code stored on the server.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>All teachers with risky capabilities have to be trusted, it is not possible to give teacher access to students. In theory teachers may use XSS attacks to gain administrator access.</p><p>Technically it would be possible to create a system where teachers can not attack other users but it would prevent all JavaScript, Flash, SCORM, Java, HTML forms, SVG, etc.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="students">Students<a class="hash-link" href="#students" title="Direct link to heading">​</a></h4><p>Students are participating in courses, they are not trusted. Students need following privileges:</p><ul><li>Post formatted text with inline images and attachments</li><li>Upload binary documents</li></ul><p>Uploaded files must not be opened directly in browser from the same server. Instead the files need to be served from different domain, or server has to force download of all files to local hard drive before opening them.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>All student submitted text has to be sanitised before printing the text on any page, this prevent XSS attacks on other users but at the same time prevents Flash, JavaScript, SVG and all other HTML scripting. Moodle uses HTML Purifier library for this purpose.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="guests">Guests<a class="hash-link" href="#guests" title="Direct link to heading">​</a></h4><p>For security reasons unregistered users can not be allowed to upload any files or submit any text that is stored in database. Guests could try to spam other users, exploit problems in HTML cleaning routines, abuse other vulnerabilities or try social engineering based attacks.</p><p>Sites with enabled user sign-up via email have to take extra care in order to prevent spamming and other types of attacks.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="capability-risks">Capability risks<a class="hash-link" href="#capability-risks" title="Direct link to heading">​</a></h3><p>Moodle is very flexible system, administrators may define multiple roles. Each role is a set of capabilities defined at system level, roles may be modified via overrides at lower context levels. Risks are part of description of each capability, administrators have to make sure only trusted users get potentially dangerous capabilities.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-types-of-security-vulnerability">Common types of security vulnerability<a class="hash-link" href="#common-types-of-security-vulnerability" title="Direct link to heading">​</a></h2><ul><li><a href="/devdocs/general/development/policies/security/unauthenticated-access">Unauthenticated access</a></li><li><a href="/devdocs/general/development/policies/security/unauthorised-access">Unauthorised access</a></li><li><a href="/devdocs/general/development/policies/security/crosssite-request-forgery">Cross-site request forgery (XSRF)</a></li><li><a href="/devdocs/general/development/policies/security/crosssite-scripting">Cross-site scripting (XSS)</a></li><li><a href="/devdocs/general/development/policies/security/sql-injection">SQL injection</a></li><li><a href="/devdocs/general/development/policies/security/commandline-injection">Command-line injection</a></li><li><a href="/devdocs/general/development/policies/security/dataloss">Data-loss</a></li><li><a href="/devdocs/general/development/policies/security/info-leakage">Confidential information leakage</a></li><li><a href="/devdocs/general/development/policies/security/configinfo-leakage">Configuration information leakage</a></li><li><a href="/devdocs/general/development/policies/security/session-fixation">Session fixation</a></li><li><a href="/devdocs/general/development/policies/security/dos">Denial of service (DOS)</a></li><li><a href="/devdocs/general/development/policies/security/bruteforcing-login">Brute-forcing login</a></li><li><a href="/devdocs/general/development/policies/security/insecure-config">Insecure configuration management</a></li><li><a href="/devdocs/general/development/policies/security/bufferoverruns">Buffer overruns and other platform weaknesses</a></li><li><a href="/devdocs/general/development/policies/security/socialengineering">Social engineering</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary-of-the-guidelines">Summary of the guidelines<a class="hash-link" href="#summary-of-the-guidelines" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="authenticate-the-user">Authenticate the user<a class="hash-link" href="#authenticate-the-user" title="Direct link to heading">​</a></h3><ul><li>With very few exceptions, every script should call <a href="/devdocs/docs/apis/subsystems/access#require_login"><code>require_login</code></a> or <a href="/devdocs/docs/apis/subsystems/access#require_course_login"><code>require_course_login</code></a> as near the start as possible.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-course-and-module-access">Verify course and module access<a class="hash-link" href="#verify-course-and-module-access" title="Direct link to heading">​</a></h3><ul><li>All course areas have to be protected by <code>require_login</code> or <code>require_course_login</code> with correct <code>$course</code> parameter.</li><li>All module areas have to be protected by <code>require_login</code> or <code>require_course_login</code> with correct <code>$course</code> and <code>$cm</code> parameter</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-permissions">Check permissions<a class="hash-link" href="#check-permissions" title="Direct link to heading">​</a></h3><ul><li>Before allowing the user to see anything or do anything, call to <a href="/devdocs/docs/apis/subsystems/access#has_capability"><code>has_capability</code></a> or <a href="/devdocs/docs/apis/subsystems/access#require_capability"><code>require_capability</code></a>.</li><li>Capabilities should be annotated with the appropriate <strong><a href="/devdocs/docs/apis/subsystems/roles#basic-risks">risks</a></strong>.</li><li>If appropriate, restrict what people can see according to <strong>groups</strong>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dont-trust-any-input-from-users">Don&#x27;t trust any input from users<a class="hash-link" href="#dont-trust-any-input-from-users" title="Direct link to heading">​</a></h3><ul><li>Use <strong><a href="/devdocs/docs/apis/subsystems/form">moodleforms</a></strong> whenever possible, with an appropriate <code>setType</code> method call for each field.</li><li>Before performing actions, use <code>data_submitted() &amp;&amp; confirm_sesskey()</code> to check sesskey and that you are handling a POST request.</li><li>Before destroying large amounts of data, add a confirmation step.</li><li>If not using a moodleform, clean input using <code>optional_param</code> or <code>required_param</code> with an appropriate <code>PARAM_...</code> type.
<strong> Do not access <code>$_GET</code>, <code>$_POST</code> or <code>$_REQUEST</code> directly.
</strong> Group optional_param and required_param calls together at the top of the script, to make them easy to find.</li></ul><p>Similarly, clean data from other external resources like RSS feeds before use.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clean-and-escape-data-before-output">Clean and escape data before output<a class="hash-link" href="#clean-and-escape-data-before-output" title="Direct link to heading">​</a></h3><ul><li>Use <code>s</code> or <code>p</code> to output plain text content.</li><li>Use <code>format_string</code> to output content with minimal HTML like multi-lang spans (for example, course and activity names).</li><li>Use <code>format_text</code> to output all other content.<ul><li>Only use <code>$options-&gt;noclean</code> if it requires a capability with <code>RISK_XSS</code> to input that content (for example web page resources).</li></ul></li><li>Data destined for JavaScript should be escaped using <code>$PAGE-&gt;requires-&gt;data_for_js</code> (Moodle 2.0 onwards) or <code>addslashes_js</code> (Moodle 1.9).</li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>More info</h5></div><div class="admonition-content"><p>We recommend that you follow the <a href="/devdocs/docs/apis/subsystems/output#output-functions">Output functions</a> to get a better understanding of how dynamic data should be sent from Moodle to the browser.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="escape-data-before-storing-it-in-the-database">Escape data before storing it in the database<a class="hash-link" href="#escape-data-before-storing-it-in-the-database" title="Direct link to heading">​</a></h3><ul><li>Use the <a href="https://docs.moodle.org/dev/XMLDB_editor" target="_blank" rel="noopener noreferrer">XMLDB</a> library. This takes care of most escaping issues for you.</li><li>When you must use custom SQL code, <strong>use place-holders</strong> to insert values into the queries.<ul><li>Before Moodle 2.0, you had to build SQL by concatenating strings. Take particular care, especially with quoting values, to avoid SQL injection vulnerabilities.</li></ul></li><li>The <code>addslashes</code> method should no longer be use anywhere in Moodle 2.0 onwards.</li><li>Variables must be passed to database queries through bound parameters.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="escape-data-before-using-it-in-shell-commands">Escape data before using it in shell commands<a class="hash-link" href="#escape-data-before-using-it-in-shell-commands" title="Direct link to heading">​</a></h3><ul><li>Avoid shell commands if at all possible.<ul><li>Look to see if there is a PHP library instead.</li></ul></li><li>If you can&#x27;t avoid shell commands, use <code>escapeshellcmd</code> and <code>escapeshellarg</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-every-request">Log every request<a class="hash-link" href="#log-every-request" title="Direct link to heading">​</a></h3><ul><li>Every script should call <code>add_to_log</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-good-practice">Other good practice<a class="hash-link" href="#other-good-practice" title="Direct link to heading">​</a></h3><p>... that helps with security:</p><ul><li>Structure your code nicely, minimising the use of global variables. This makes the flow of data, and hence security, easier to verify.</li><li>Initialise objects (for instance, <code>$x = new stdClass;</code>) and arrays (<code>$x = array()</code>) before you first use them.</li><li>Test every input field with tricky input to ensure that it is escaped and un-escaped the right number of times everywhere, and that Unicode characters are not corrupted. One standard test you can use is:</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt; &gt; &amp; &amp;lt; &amp;gt; &amp;amp; &#x27; \&#x27; 碁 \ \\</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="see-also">See also<a class="hash-link" href="#see-also" title="Direct link to heading">​</a></h2><ul><li><a href="/devdocs/general/development/process#security-issues">Security issue process</a></li><li><a href="/devdocs/general/development/policies">Coding</a></li><li>The <a href="http://cwe.mitre.org/top25/" target="_blank" rel="noopener noreferrer">2010 CWE/SANS Top 25 Most Dangerous Programming Errors</a> - this is a generic list of common security mistakes, produced by a group of security experts. The above Moodle-specific guidelines cover most of these general points.</li><li><a href="https://www.owasp.org/index.php/PHP_Security_Cheat_Sheet" target="_blank" rel="noopener noreferrer">PHP Security Cheat Sheet</a></li><li><a href="https://www.owasp.org/index.php/Main_Page" target="_blank" rel="noopener noreferrer">The Open Web Application Security Project (OWASP)</a> - Large collection of documentation and code samples about preventing security issues while using web technologies.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/devdocs/general/tags/coding-guidelines">Coding guidelines</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/devdocs/general/tags/developer-processes">Developer processes</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/devdocs/general/tags/policies">Policies</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/devdocs/general/tags/security">Security</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/moodle/devdocs/edit/main/general/development/policies/security/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-06-17T11:03:23.000Z">17/06/2022</time></b> by <b>Andrew Lyons</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/devdocs/general/development/policies/naming"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Naming conventions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/devdocs/general/development/policies/security/unauthenticated-access"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Unauthenticated access</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#security-of-web-applications" class="table-of-contents__link toc-highlight">Security of web applications</a><ul><li><a href="#secure-web-app-requirements" class="table-of-contents__link toc-highlight">Secure web app requirements</a></li><li><a href="#balanced-security" class="table-of-contents__link toc-highlight">Balanced security</a></li></ul></li><li><a href="#moodle-security-design" class="table-of-contents__link toc-highlight">Moodle security design</a><ul><li><a href="#types-of-users" class="table-of-contents__link toc-highlight">Types of users</a></li><li><a href="#capability-risks" class="table-of-contents__link toc-highlight">Capability risks</a></li></ul></li><li><a href="#common-types-of-security-vulnerability" class="table-of-contents__link toc-highlight">Common types of security vulnerability</a></li><li><a href="#summary-of-the-guidelines" class="table-of-contents__link toc-highlight">Summary of the guidelines</a><ul><li><a href="#authenticate-the-user" class="table-of-contents__link toc-highlight">Authenticate the user</a></li><li><a href="#verify-course-and-module-access" class="table-of-contents__link toc-highlight">Verify course and module access</a></li><li><a href="#check-permissions" class="table-of-contents__link toc-highlight">Check permissions</a></li><li><a href="#dont-trust-any-input-from-users" class="table-of-contents__link toc-highlight">Don&#39;t trust any input from users</a></li><li><a href="#clean-and-escape-data-before-output" class="table-of-contents__link toc-highlight">Clean and escape data before output</a></li><li><a href="#escape-data-before-storing-it-in-the-database" class="table-of-contents__link toc-highlight">Escape data before storing it in the database</a></li><li><a href="#escape-data-before-using-it-in-shell-commands" class="table-of-contents__link toc-highlight">Escape data before using it in shell commands</a></li><li><a href="#log-every-request" class="table-of-contents__link toc-highlight">Log every request</a></li><li><a href="#other-good-practice" class="table-of-contents__link toc-highlight">Other good practice</a></li></ul></li><li><a href="#see-also" class="table-of-contents__link toc-highlight">See also</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Moodle</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/devdocs/general/releases">Release notes</a></li><li class="footer__item"><a class="footer__link-item" href="/devdocs/general/projects">Projects</a></li></ul></div><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/devdocs/general/documentation">Developer docs</a></li><li class="footer__item"><a href="https://docs.moodle.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">User docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.moodle.org/dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Legacy docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/devdocs/general/documentation/code-of-conduct">Code of conduct</a></li><li class="footer__item"><a href="https://moodle.org/mod/forum/view.php?id=55" target="_blank" rel="noopener noreferrer" class="footer__link-item">General Developer Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/moodle" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/moodle" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item">
                    <a href="https://www.netlify.com" target="_blank" rel="noreferrer noopener" aria-label="Deploys by Netlify">
                        <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify" width="114" height="51">
                    </a>
                    </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
Copyright © 2022 Moodle Pty Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/devdocs/assets/js/runtime~main.108433aa.js"></script>
<script src="/devdocs/assets/js/main.2dbacd86.js"></script>
</body>
</html>